<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <title>EchoMarket - HoÅŸ Geldiniz</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* --- TEMA DEÄžÄ°ÅžKENLERÄ° --- */
        :root {
            --bg-color: #000000;
            --text-color: #FFFF00;
            --btn-bg: #1A1A1A;
            --btn-border: #FFFF00;
            --btn-text: #FFFFFF; /* Buton iÃ§i yazÄ± rengi */
            --mic-border: #FFFFFF;
            --pulse-color: #00FF00;
        }
        body.light-mode {
            --bg-color: #FFFFFF;
            --text-color: #000000;
            --btn-bg: #F0F0F0;
            --btn-border: #000000;
            --btn-text: #000000;
            --mic-border: #000000;
            --pulse-color: #00AA00;
        }

        body {
            background-color: var(--bg-color);
            color: var(--text-color);
            font-family: 'Arial', sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100vh;
            margin: 0;
            text-align: center;
            transition: 0.3s;
        }

        /* ORTALAMA Ä°Ã‡Ä°N DÃœZELTME */
        .choice-container {
            display: flex;
            gap: 40px;
            width: 100%;
            max-width: 800px;
            justify-content: center;
            margin-top: 30px;
        }

        /* Linkleri Buton Gibi GÃ¶steriyoruz */
        .big-btn {
            flex: 1;
            padding: 30px;
            font-size: 32px;
            font-weight: bold;
            background: var(--btn-bg);
            color: var(--btn-text);
            border: 4px solid var(--btn-border);
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s;
            text-decoration: none; /* Alt Ã§izgiyi kaldÄ±r */
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .big-btn:hover {
            transform: translateY(-5px);
            background-color: var(--text-color); /* Hoverda zÄ±t renk */
            color: var(--bg-color);
        }

        .theme-toggle-wrapper { position: absolute; top: 20px; right: 20px; }

        .btn-theme {
            background: transparent;
            border: 2px solid var(--text-color);
            color: var(--text-color);
            padding: 10px 20px;
            border-radius: 30px;
            cursor: pointer;
            font-weight: bold;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .mic-button { width: 180px; height: 180px; border-radius: 50%; background: linear-gradient(135deg, #FFFF00 0%, #FFD700 100%); border: 8px solid var(--mic-border); font-size: 70px; display: flex; align-items: center; justify-content: center; cursor: pointer; transition: 0.3s; }
        .mic-button:hover { transform: scale(1.05); }
        .mic-button.listening { animation: pulse 1.5s infinite; background: var(--pulse-color); }

        @keyframes pulse { 0% {box-shadow: 0 0 0 0 rgba(0,255,0,0.7);} 70% {box-shadow: 0 0 0 30px rgba(0,255,0,0);} }
    </style>
</head>
<body>
<div class="theme-toggle-wrapper">
    <button id="themeToggle" class="btn-theme">
        <i class="fas fa-adjust"></i> Tema
    </button>
</div>

<h1>EchoMarket</h1>
<p style="font-size: 24px; max-width: 600px;">GiriÅŸ yapmak iÃ§in <b>"GiriÅŸ"</b>, kayÄ±t olmak iÃ§in <b>"KayÄ±t"</b> deyin.</p>

<button id="micButton" class="mic-button">ðŸŽ¤</button>
<div id="status" style="font-size: 24px; margin-top: 20px; font-weight: bold;">Mikrofona basÄ±n</div>

<div class="choice-container">
    <a href="/login" class="big-btn">GÄ°RÄ°Åž YAP</a>
    <a href="/register" class="big-btn">KAYIT OL</a>
</div>

<script>
    const micButton = document.getElementById('micButton');
    const statusDiv = document.getElementById('status');
    let isListening = false;

    // KonuÅŸma Fonksiyonu (TTS)
    function speak(text) {
        window.speechSynthesis.cancel();
        const u = new SpeechSynthesisUtterance(text);
        u.lang = 'tr-TR';
        window.speechSynthesis.speak(u);
    }

    // Dinleme Fonksiyonu
    async function listen() {
        if (isListening) return;

        isListening = true;
        micButton.classList.add('listening');
        statusDiv.textContent = "Dinliyorum...";

        try {
            const res = await fetch('/dinle', { method: 'POST' });
            const data = await res.json();

            isListening = false;
            micButton.classList.remove('listening');

            if (data.status === 'success') {
                statusDiv.textContent = data.message;

                if (data.action === 'redirect' && data.redirect_url) {
                    speak(data.message);
                    setTimeout(() => {
                        window.location.href = data.redirect_url;
                    }, 1000);
                } else {
                    speak(data.message);
                }
            } else {
                statusDiv.textContent = data.message;
                speak(data.message);
            }

        } catch (err) {
            console.error(err);
            isListening = false;
            micButton.classList.remove('listening');
            statusDiv.textContent = "Hata oluÅŸtu.";
            speak("Bir hata oluÅŸtu.");
        }
    }

    micButton.addEventListener('click', listen);

    document.addEventListener('keydown', (e) => {
        if (e.code === 'Space' || e.key === ' ') {
            e.preventDefault();
            listen();
        }
    });
</script>

<script src="{{ url_for('static', filename='theme.js') }}"></script>
</body>
</html>